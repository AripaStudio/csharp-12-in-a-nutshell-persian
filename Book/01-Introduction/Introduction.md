## آشنایی با سی‌شارپ و دات‌نت

سی‌شارپ یک زبان برنامه‌نویسی همه‌منظوره، با امنیت نوع (type-safe) و شی‌ءگرا است. هدف این زبان، افزایش بهره‌وری برنامه‌نویسان است. بدین منظور، سی‌شارپ بین سادگی، گویایی و عملکرد، تعادل ایجاد می‌کند. معمار اصلی این زبان از اولین نسخه آن، آندرس هجسلبرگ (خالق توربو پاسکال و معمار دلفی) بوده است.

زبان سی‌شارپ مستقل از بستر (platform neutral) است و با طیف وسیعی از محیط‌های اجرایی (runtimes) مختص هر بستر کار می‌کند.

## شی‌ءگرایی

سی‌شارپ یک پیاده‌سازی غنی از پارادایم شی‌ءگرایی است که شامل کپسوله‌سازی (encapsulation)، وراثت (inheritance) و چندریختی (polymorphism) می‌شود. کپسوله‌سازی به معنای ایجاد یک مرز در اطراف یک شیء برای جدا کردن رفتار بیرونی (عمومی) آن از جزئیات پیاده‌سازی داخلی (خصوصی) است. در ادامه، ویژگی‌های متمایز سی‌شارپ از منظر شی‌ءگرایی آمده است:

سامانه نوع یکپارچه:
بلوک ساختاری اساسی در سی‌شارپ، یک واحد کپسوله‌شده از داده‌ها و توابع است که نوع نامیده می‌شود. سی‌شارپ دارای یک سامانه نوع یکپارچه است که در آن همه انواع، در نهایت یک نوع پایه مشترک دارند. این بدان معناست که همه انواع، چه نشان‌دهنده اشیاء کسب‌وکار باشند و چه انواع اولیه مانند اعداد، از همان عملکرد پایه مشترک برخوردارند. به عنوان مثال، یک نمونه از هر نوع را می‌توان با فراخوانی متد تبدیل به رشته (ToString) آن، به رشته تبدیل کرد.

کلاس‌ها و رابط‌ها:
در یک پارادایم سنتی شی‌ءگرا، تنها نوع موجود، کلاس است. در سی‌شارپ، چندین نوع دیگر نیز وجود دارد که یکی از آن‌ها رابط است. رابط مانند کلاسی است که نمی‌تواند داده نگه دارد. این بدان معناست که تنها می‌تواند رفتار را تعریف کند (و نه وضعیت را)، که امکان وراثت چندگانه و همچنین جدایی بین مشخصات و پیاده‌سازی را فراهم می‌کند.

خصوصیات، متدها و رویدادها:
در پارادایم شی‌ءگرای محض، همه توابع، متد هستند. در سی‌شارپ، متدها تنها یکی از انواع اعضای تابع هستند که شامل خصوصیات (properties) و رویدادها (events) نیز می‌شوند (انواع دیگری هم وجود دارند). خصوصیات، اعضای تابعی هستند که بخشی از وضعیت یک شیء را کپسوله‌سازی می‌کنند، مانند رنگ یک دکمه یا متن یک برچسب. رویدادها نیز اعضای تابعی هستند که ساده‌سازی واکنش به تغییرات وضعیت شیء را به عهده دارند.

اگرچه سی‌شارپ در درجه اول یک زبان شی‌ءگرا است، اما از پارادایم برنامه‌نویسی تابعی نیز الهام گرفته است، به ویژه در موارد زیر:

توابع را می‌توان به عنوان مقادیر در نظر گرفت:
با استفاده از نمایندگان (delegates)، سی‌شارپ اجازه می‌دهد تا توابع به عنوان مقادیر به توابع دیگر فرستاده و از آن‌ها بازگردانده شوند.

سی‌شارپ از الگوهایی برای پاکی پشتیبانی می‌کند:
هسته اصلی برنامه‌نویسی تابعی، پرهیز از استفاده از متغیرهایی است که مقادیرشان تغییر می‌کند، به نفع الگوهای اعلانی. سی‌شارپ ویژگی‌های کلیدی برای کمک به این الگوها دارد، از جمله توانایی نوشتن توابع بی‌نام به صورت لحظه‌ای که متغیرها را "شکار" می‌کنند (عبارات لامبدا) و توانایی انجام برنامه‌نویسی لیست یا واکنشی از طریق عبارات پرس‌وجو. سی‌شارپ همچنین سوابق (records) را فراهم می‌کند که نوشتن انواع تغییرناپذیر (فقط خواندنی) را آسان می‌کند.

## امنیت نوع

سی‌شارپ در درجه اول یک زبان با امنیت نوع است، به این معنی که نمونه‌های انواع تنها می‌توانند از طریق پروتکل‌هایی که تعریف می‌کنند با یکدیگر تعامل داشته باشند، که این امر سازگاری داخلی هر نوع را تضمین می‌کند. به عنوان مثال، سی‌شارپ شما را از تعامل با یک نوع رشته به گونه‌ای که گویی یک نوع عدد صحیح است، باز می‌دارد.

به طور خاص‌تر، سی‌شارپ از تایپ ایستا (Static Typing) پشتیبانی می‌کند، به این معنی که زبان، امنیت نوع را در زمان کامپایل (Compile Time) اعمال می‌کند. این علاوه بر امنیت نوع است که در زمان اجرا (Runtime) نیز اعمال می‌شود. تایپ ایستا بخش بزرگی از خطاها را قبل از اجرای برنامه از بین می‌برد. بار بررسی صحت مطابقت انواع در یک برنامه را از آزمون‌های واحد زمان اجرا به کامپایلر منتقل می‌کند. این باعث می‌شود مدیریت برنامه‌های بزرگ بسیار آسان‌تر، قابل پیش‌بینی‌تر و مقاوم‌تر شود. علاوه بر این، تایپ ایستا به ابزارهایی مانند IntelliSense در ویژوال استودیو امکان می‌دهد تا به شما در نوشتن برنامه کمک کنند، زیرا برای یک متغیر مشخص، نوع آن را می‌داند و در نتیجه می‌داند چه متدهایی را می‌توانید روی آن متغیر فراخوانی کنید. چنین ابزارهایی همچنین می‌توانند هر جایی از برنامه شما که یک متغیر، نوع یا متد استفاده شده است را شناسایی کرده و امکان بازسازی (Refactoring) قابل اعتماد را فراهم کنند.

سی‌شارپ همچنین اجازه می‌دهد بخش‌هایی از کد شما از طریق کلمه کلیدی پویا (dynamic) به صورت پویا تایپ شوند. با این حال، سی‌شارپ همچنان یک زبان عمدتاً با تایپ ایستا باقی می‌ماند.

سی‌شارپ همچنین یک زبان قوی‌تایپ (Strongly Typed) نامیده می‌شود، زیرا قوانین نوع آن به شدت اعمال می‌شوند (چه به صورت ایستا و چه در زمان اجرا). به عنوان مثال، نمی‌توانید تابعی را که برای پذیرش یک عدد صحیح طراحی شده است، با یک عدد اعشاری فراخوانی کنید، مگر اینکه ابتدا به صراحت عدد اعشاری را به عدد صحیح تبدیل کنید. این به جلوگیری از اشتباهات کمک می‌کند.

## مدیریت حافظه

سی‌شارپ برای انجام مدیریت خودکار حافظه، به محیط زمان اجرا (runtime) متکی است. محیط زمان اجرای مشترک (Common Language Runtime) دارای یک جمع‌آوری‌کننده زباله (garbage collector) است که به عنوان بخشی از برنامه شما اجرا می‌شود و حافظه اشیائی را که دیگر به آن‌ها ارجاعی داده نمی‌شود، بازپس می‌گیرد. این کار برنامه‌نویسان را از آزادسازی صریح حافظه برای یک شیء رها می‌کند و مشکل اشاره‌گرهای نادرست که در زبان‌هایی مانند سی‌پلاس‌پلاس با آن‌ها مواجه می‌شدیم، از بین می‌برد.

سی‌شارپ اشاره‌گرها را به طور کامل حذف نمی‌کند: صرفاً آن‌ها را برای بیشتر وظایف برنامه‌نویسی غیرضروری می‌سازد. برای نقاط حساس به عملکرد (performance-critical hotspots) و تعامل‌پذیری (interoperability)، استفاده از اشاره‌گرها و تخصیص صریح حافظه در بلوک‌هایی که با عنوان "ناامن" (unsafe) علامت‌گذاری شده‌اند، مجاز است.

## پشتیبانی از بسترها

سی‌شارپ دارای محیط‌های اجرایی است که از بسترهای زیر پشتیبانی می‌کنند:

رومیزی ویندوز ۷ به بالا (برای برنامه‌های مشتری غنی، وب، سرور و خط فرمان)
سیستم‌عامل مک (برای برنامه‌های وب و خط فرمان – و برنامه‌های مشتری غنی از طریق مک کاتالیست)
لینوکس (برای برنامه‌های وب و خط فرمان)
اندروید و آی‌او‌اس (برای برنامه‌های موبایل)
دستگاه‌های ویندوز ۱۰ (ایکس‌باکس، سرفیس هاب و هولولنز) از طریق سکوی برنامه‌نویسی جهانی ویندوز (UWP)
همچنین فناوری‌ای به نام بلِیْزر وجود دارد که می‌تواند سی‌شارپ را به اسمبلیکد وب (web assembly) کامپایل کند که در مرورگر اجرا می‌شود.

## محیط‌های زمان اجرا (CLRs)، کتابخانه‌های کلاس پایه (BCLs) و رانتایم‌ها

پشتیبانی محیط زمان اجرا برای برنامه‌های سی‌شارپ شامل یک محیط زمان اجرای مشترک و یک کتابخانه کلاس پایه است. یک محیط زمان اجرا همچنین می‌تواند شامل یک لایه کاربردی سطح بالاتر باشد که شامل کتابخانه‌هایی برای توسعه برنامه‌های مشتری غنی، موبایل یا وب است (به تصویر ۱-۱ مراجعه کنید). محیط‌های زمان اجرای مختلف برای انواع مختلفی از برنامه‌ها و همچنین بسترهای متفاوت وجود دارند.

<div align="center">
  
  ![Conventions-UsedThis-Book](../../assets/image/01/Runtime-architecture.png) 
  
</div>

## محیط زمان اجرای مشترک

یک محیط زمان اجرای مشترک (CLR) خدمات اساسی زمان اجرا را فراهم می‌کند، از جمله مدیریت خودکار حافظه و رسیدگی به خطاها. (کلمه "مشترک" به این واقعیت اشاره دارد که همین محیط زمان اجرا می‌تواند توسط سایر زبان‌های برنامه‌نویسی مدیریت شده، مانند اف‌شارپ، ویژوال بیسیک، و سی‌پلاس‌پلاس مدیریت شده، به اشتراک گذاشته شود.)

سی‌شارپ یک زبان "مدیریت شده" نامیده می‌شود، زیرا کد منبع را به کد مدیریت شده (managed code) کامپایل می‌کند که در قالب زبان میانی (Intermediate Language - IL) نمایش داده می‌شود. محیط زمان اجرای مشترک (CLR) زبان میانی را به کد بومی ماشین (native code)، مانند X64 یا X86، معمولاً دقیقاً قبل از اجرا تبدیل می‌کند. به این فرآیند کامپایل در لحظه (Just-In-Time - JIT) گفته می‌شود. کامپایل پیش از زمان اجرا (Ahead-of-Time compilation) نیز برای بهبود زمان راه‌اندازی با مجموعه‌های بزرگ یا دستگاه‌های با منابع محدود (و برای رعایت قوانین فروشگاه برنامه‌های آی‌او‌اس هنگام توسعه برنامه‌های موبایل) در دسترس است.

ظرف حاوی کد مدیریت شده، مجموعه (Assembly) نامیده می‌شود. یک مجموعه نه تنها شامل زبان میانی، بلکه شامل اطلاعات نوع (metadata) نیز هست. وجود اطلاعات نوع به مجموعه‌ها اجازه می‌دهد تا به انواع موجود در سایر مجموعه‌ها بدون نیاز به فایل‌های اضافی ارجاع دهند.

شما می‌توانید محتویات یک مجموعه را با ابزار ildasm مایکروسافت بررسی و جداسازی (disassemble) کنید. و با ابزارهایی مانند ILSpy یا JetBrains dotPeek، می‌توانید فراتر رفته و زبان میانی را به سی‌شارپ دیکامپایل (decompile) کنید. از آنجا که زبان میانی سطح بالاتری نسبت به کد بومی ماشین دارد، ابزارهای دیکامپایلر می‌توانند کار بسیار خوبی در بازسازی سی‌شارپ اصلی انجام دهند.

یک برنامه می‌تواند اطلاعات نوع خودش را پرس‌وجو کند (بازتاب - reflection) و حتی در زمان اجرا، زبان میانی جدیدی تولید کند (reflection.emit).

## کتابخانه کلاس پایه

یک محیط زمان اجرای مشترک (CLR) همیشه همراه با مجموعه‌ای از کتابخانه‌ها عرضه می‌شود که کتابخانه کلاس پایه (Base Class Library - BCL) نامیده می‌شوند. یک کتابخانه کلاس پایه، قابلیت‌های اصلی را به برنامه‌نویسان ارائه می‌دهد، مانند مجموعه‌ها (collections)، ورودی/خروجی، پردازش متن، مدیریت XML/JSON، شبکه‌سازی، رمزنگاری، تعامل‌پذیری (interop)، همروندی (concurrency) و برنامه‌نویسی موازی.

یک کتابخانه کلاس پایه همچنین انواعی را که خود زبان سی‌شارپ نیاز دارد (برای ویژگی‌هایی مانند شمارش، پرس‌وجو و ناهمگامی) پیاده‌سازی می‌کند و به شما امکان می‌دهد مستقیماً به ویژگی‌های محیط زمان اجرای مشترک (CLR)، مانند بازتاب و مدیریت حافظه، دسترسی پیدا کنید.

## محیط‌های اجرایی

یک محیط اجرایی (runtime) (که گاهی اوقات "چارچوب" (framework) نیز نامیده می‌شود) یک واحد قابل استقرار است که آن را دانلود و نصب می‌کنید. یک محیط اجرایی از یک محیط زمان اجرای مشترک (CLR) (همراه با کتابخانه کلاس پایه آن) به علاوه یک لایه کاربردی اختیاری خاص برای نوع برنامه‌ای که می‌نویسید – وب، موبایل، مشتری غنی و غیره – تشکیل شده است. (اگر در حال نوشتن یک برنامه کنسولی خط فرمان یا یک کتابخانه بدون رابط کاربری هستید، نیازی به لایه کاربردی ندارید.)

هنگام نوشتن یک برنامه، شما یک محیط اجرایی خاص را هدف قرار می‌دهید، به این معنی که برنامه شما از قابلیت‌هایی که آن محیط اجرایی فراهم می‌کند، استفاده می‌کند و به آن‌ها وابسته است. انتخاب محیط اجرایی شما همچنین تعیین می‌کند که برنامه شما از کدام بسترها پشتیبانی خواهد کرد.

جدول زیر گزینه‌های اصلی محیط‌های اجرایی را فهرست می‌کند:

<div align="center">
  
  ![Conventions-UsedThis-Book](../../assets/image/01/Introduction-02.png) 
  
</div>

تصویر ۱-۲ این اطلاعات را به صورت گرافیکی نمایش می‌دهد و همچنین به عنوان راهنمایی برای مطالبی که در کتاب پوشش داده شده‌اند، عمل می‌کند.

<div align="center">
  
  ![Conventions-UsedThis-Book](../../assets/image/01/Introduction-03.png) 
  
</div>

##  .NET 8

دات‌نت ۸ محیط زمان اجرای متن‌باز و پرچم‌دار مایکروسافت است. شما می‌توانید برنامه‌های وب و کنسول را بنویسید که روی ویندوز، لینوکس و سیستم‌عامل مک اجرا می‌شوند؛ برنامه‌های مشتری غنی (rich-client) که روی ویندوز ۱۰ به بالا و سیستم‌عامل مک اجرا می‌شوند؛ و برنامه‌های موبایل که روی آی‌او‌اس و اندروید اجرا می‌شوند. این کتاب بر محیط زمان اجرای مشترک (CLR) و کتابخانه کلاس پایه (BCL) دات‌نت ۸ تمرکز دارد.

بر خلاف چارچوب دات‌نت (NET Framework.)، دات‌نت ۸ به صورت پیش‌فرض روی دستگاه‌های ویندوزی نصب نیست. اگر سعی کنید یک برنامه دات‌نت ۸ را بدون حضور محیط زمان اجرای صحیح اجرا کنید، پیامی ظاهر می‌شود که شما را به یک صفحه وب برای دانلود محیط زمان اجرا هدایت می‌کند. می‌توانید با ایجاد یک استقرار خودکفا (self-contained deployment)، که شامل بخش‌های مورد نیاز محیط زمان اجرا برای برنامه است، از این امر جلوگیری کنید.

تاریخچه به‌روزرسانی‌های دات‌نت به شرح زیر است: دات‌نت کور ۱.x → دات‌نت کور ۲.x → دات‌نت کور ۳.x → دات‌نت ۵ → دات‌نت ۶ → دات‌نت ۷ → دات‌نت ۸. پس از دات‌نت کور ۳، مایکروسافت واژه "کور" را از نام حذف کرد و از نسخه ۴ صرف‌نظر کرد تا از سردرگمی با چارچوب دات‌نت ۴.x که پیش از تمام محیط‌های اجرایی قبلی قرار دارد اما هنوز پشتیبانی می‌شود و به طور گسترده مورد استفاده است، جلوگیری کند.

این بدان معناست که مجموعه‌های کامپایل شده تحت دات‌نت کور ۱.x تا دات‌نت ۷، در بیشتر موارد، بدون تغییر تحت دات‌نت ۸ اجرا خواهند شد. در مقابل، مجموعه‌های کامپایل شده تحت (هر نسخه‌ای از) چارچوب دات‌نت معمولاً با دات‌نت ۸ ناسازگار هستند.

## Windows Desktop and WinUI 3

برای نوشتن برنامه‌های مشتری غنی که روی ویندوز ۱۰ به بالا اجرا می‌شوند، می‌توانید بین رابط‌های برنامه‌نویسی کاربردی کلاسیک رومیزی ویندوز (فرم‌های ویندوز و WPF) و رابط کاربری ویندوز ۳ انتخاب کنید. رابط‌های برنامه‌نویسی کاربردی رومیزی ویندوز بخشی از محیط زمان اجرای دسکتاپ دات‌نت هستند، در حالی که رابط کاربری ویندوز ۳ بخشی از بسته توسعه نرم‌افزاری برنامه‌های ویندوز (Windows App SDK) است (یک دانلود جداگانه).

رابط‌های برنامه‌نویسی کاربردی کلاسیک رومیزی ویندوز از سال ۲۰۰۶ وجود داشته‌اند و از پشتیبانی عالی کتابخانه‌های شخص ثالث و همچنین منابع غنی از سوالات پاسخ داده شده در سایت‌هایی مانند استک‌اُوِرفلو برخوردارند. رابط کاربری ویندوز ۳ در سال ۲۰۲۲ منتشر شد و برای نوشتن برنامه‌های غوطه‌ور و مدرن که شامل جدیدترین کنترل‌های ویندوز ۱۰ به بالا هستند، در نظر گرفته شده است. این رابط، جانشین سکوی برنامه‌نویسی جهانی ویندوز (UWP) است.

## MAUI

مویی (MAUI - رابط کاربری برنامه چندبستری) در درجه اول برای ایجاد برنامه‌های موبایل برای آی‌او‌اس و اندروید طراحی شده است، اگرچه می‌توان از آن برای برنامه‌های رومیزی که روی سیستم‌عامل مک و ویندوز از طریق مک کاتالیست و رابط کاربری ویندوز ۳ اجرا می‌شوند نیز استفاده کرد. مویی تکامل یافته زامارین (Xamarin) است و اجازه می‌دهد یک پروژه واحد چندین بستر را هدف قرار دهد.

برای برنامه‌های رومیزی چندبستری، یک کتابخانه شخص ثالث به نام آوالونیا (Avalonia) جایگزینی برای مویی ارائه می‌دهد. آوالونیا روی لینوکس نیز اجرا می‌شود و از نظر معماری ساده‌تر از مویی است (زیرا بدون لایه غیرمستقیم کاتالیست/رابط کاربری ویندوز عمل می‌کند). آوالونیا یک رابط برنامه‌نویسی کاربردی شبیه به WPF دارد، و همچنین یک افزونه تجاری به نام XPF ارائه می‌دهد که سازگاری تقریباً کاملی با WPF فراهم می‌کند.

 ## .NET Framework

چارچوب دات‌نت (NET Framework.)، محیط زمان اجرای اصلی مایکروسافت فقط برای ویندوز است که برای نوشتن برنامه‌های وب و مشتری غنی که (فقط) روی رومیزی/سرور ویندوز اجرا می‌شوند، به کار می‌رود. هیچ نسخه اصلی جدیدی برای آن برنامه‌ریزی نشده است، اگرچه مایکروسافت به دلیل وجود حجم زیادی از برنامه‌های موجود، به پشتیبانی و نگهداری نسخه ۴.۸ فعلی ادامه خواهد داد.

با چارچوب دات‌نت، محیط زمان اجرای مشترک (CLR) و کتابخانه کلاس پایه (BCL) با لایه کاربردی ادغام شده‌اند. برنامه‌های نوشته شده در چارچوب دات‌نت را می‌توان تحت دات‌نت ۸ مجدداً کامپایل کرد، اگرچه معمولاً نیاز به تغییراتی دارند. برخی از ویژگی‌های چارچوب دات‌نت در دات‌نت ۸ وجود ندارند (و برعکس).

چارچوب دات‌نت به صورت پیش‌فرض با ویندوز نصب می‌شود و به طور خودکار از طریق به‌روزرسانی ویندوز اصلاح (patch) می‌گردد. هنگامی که چارچوب دات‌نت ۴.۸ را هدف قرار می‌دهید، می‌توانید از ویژگی‌های سی‌شارپ ۷.۳ و نسخه‌های قبلی استفاده کنید. (می‌توانید با مشخص کردن یک نسخه زبان جدیدتر در فایل پروژه این را لغو کنید – این کار تمام جدیدترین ویژگی‌های زبان را باز می‌کند، به جز مواردی که نیاز به پشتیبانی از یک محیط زمان اجرای جدیدتر دارند.)

کلمه "دات‌نت" مدت‌هاست که به عنوان یک اصطلاح چترگونه برای هر فناوری‌ای که شامل کلمه "دات‌نت" است (چارچوب دات‌نت، دات‌نت کور، دات‌نت استاندارد و غیره) به کار رفته است.

این بدان معناست که تغییر نام دات‌نت کور به دات‌نت توسط مایکروسافت، ابهام نامطلوبی ایجاد کرده است. در این کتاب، هنگامی که ابهامی پیش می‌آید، به دات‌نت جدید به عنوان "دات‌نت ۵ به بالا" اشاره خواهیم کرد. و برای اشاره به دات‌نت کور و جانشینان آن، از عبارت "دات‌نت کور و دات‌نت ۵ به بالا" استفاده خواهیم کرد.

برای افزودن به سردرگمی، دات‌نت (۵ به بالا) یک چارچوب (framework) است، با این حال بسیار متفاوت از چارچوب دات‌نت (NET Framework.) است. از این رو، هر جا که ممکن باشد، اصطلاح "محیط زمان اجرا" (runtime) را به "چارچوب" (framework) ترجیح می‌دهیم.

## محیط‌های اجرایی خاص Niche Runtimes

همچنین محیط‌های اجرایی خاص زیر وجود دارند:

یونیتی (Unity): یک سکوی توسعه بازی است که اجازه می‌دهد منطق بازی با سی‌شارپ نوشته شود.

سکوی برنامه‌نویسی جهانی ویندوز (UWP): برای نوشتن برنامه‌های لمسی‌محور (touch-first) طراحی شده بود که روی رومیزی ویندوز ۱۰ به بالا و دستگاه‌ها، از جمله ایکس‌باکس، سرفیس هاب و هولولنز اجرا می‌شوند. برنامه‌های سکوی برنامه‌نویسی جهانی ویندوز در محیط ایزوله (sandboxed) اجرا می‌شوند و از طریق فروشگاه ویندوز منتشر می‌گردند. سکوی برنامه‌نویسی جهانی ویندوز از نسخه‌ای از محیط زمان اجرای مشترک (CLR) و کتابخانه کلاس پایه (BCL) دات‌نت کور ۲.۲ استفاده می‌کند و بعید است که این وابستگی به‌روزرسانی شود؛ در عوض، مایکروسافت توصیه کرده است که کاربران به جایگزین مدرن آن، یعنی رابط کاربری ویندوز ۳، روی بیاورند. اما از آنجا که رابط کاربری ویندوز ۳ تنها از رومیزی ویندوز پشتیبانی می‌کند، سکوی برنامه‌نویسی جهانی ویندوز همچنان برای هدف قرار دادن ایکس‌باکس، سرفیس هاب و هولولنز یک کاربرد خاص دارد.

چارچوب کوچک دات‌نت (NET Micro Framework.): برای اجرای کدهای دات‌نت روی دستگاه‌های تعبیه شده با منابع بسیار محدود (زیر یک مگابایت) است.

همچنین امکان اجرای کد مدیریت شده در داخل اس‌کیو‌ال سرور نیز وجود دارد. با ادغام محیط زمان اجرای مشترک (CLR) اس‌کیو‌ال سرور، می‌توانید توابع سفارشی، رویه‌های ذخیره شده (stored procedures) و تجمعات (aggregations) را در سی‌شارپ بنویسید و سپس آن‌ها را از اس‌کیو‌ال فراخوانی کنید. این قابلیت در ترکیب با چارچوب دات‌نت و یک محیط زمان اجرای مشترک "میزبان شده" (hosted CLR) کار می‌کند که یک محیط ایزوله را برای محافظت از یکپارچگی فرآیند اس‌کیو‌ال سرور اعمال می‌کند.

## تاریخچه‌ای کوتاه از سی‌شارپ

در ادامه، یک گاه‌شمار معکوس از ویژگی‌های جدید در هر نسخه سی‌شارپ، برای خوانندگانی که قبلاً با نسخه قدیمی‌تر زبان آشنا هستند، آورده شده است.

## تازه‌های سی‌شارپ ۱۲

سی‌شارپ ۱۲ همراه با ویژوال استودیو ۲۰۲۲ عرضه می‌شود و هنگامی که دات‌نت ۸ را هدف قرار می‌دهید، استفاده می‌شود.

## Collection expressions

به جای مقداردهی اولیه یک آرایه به شکل زیر:
```
char[] vowels = {'a','e','i','o','u'};
```

اکنون می‌توانید از براکت‌های مربعی (که یک عبارت مجموعه است) استفاده کنید:
```
char[] vowels = ['a','e','i','o','u'];
```
عبارات مجموعه دو مزیت عمده دارند. اول اینکه، همین نحو برای انواع مجموعه‌ای دیگر، مانند لیست‌ها و مجموعه‌ها (و حتی انواع اسپَن سطح پایین) نیز کار می‌کند:
```
List list         = ['a','e','i','o','u'];
HashSet set       = ['a','e','i','o','u'];
ReadOnlySpan span = ['a','e','i','o','u'];
```
دوم اینکه، آن‌ها نوع-هدف هستند، به این معنی که در سناریوهای دیگری که کامپایلر می‌تواند نوع را استنباط کند، می‌توانید نوع را حذف کنید، مانند هنگام فراخوانی متدها:
```
Foo (['a','e','i','o','u']);
void Foo (char[] letters) { ... }
```
برای جزئیات بیشتر، به "مقداردهنده‌های اولیه مجموعه و عبارات مجموعه" در صفحه ۲۰۵ مراجعه کنید.

## سازنده‌های اصلی در کلاس‌ها و ساختارها  Primary constructors in classes and structs

از سی‌شارپ ۱۲ به بعد، می‌توانید یک لیست پارامتر را مستقیماً پس از اعلان کلاس (یا ساختار) قرار دهید:

```C#

class Person (string firstName, string lastName)
{
  public void Print() => Console.WriteLine (firstName + " " + lastName);
}
```
این دستور به کامپایلر می‌گوید که به طور خودکار یک سازنده اصلی بسازد، که امکان استفاده زیر را فراهم می‌کند:

```C#

Person p = new Person ("Alice", "Jones");
p.Print();    // Alice Jones
```
این ویژگی از سی‌شارپ ۹ با رِکوردها وجود داشته است—که در آنجا رفتار کمی متفاوتی دارند. با رِکوردها، کامپایلر (به طور پیش‌فرض) یک خصوصیت init-only عمومی برای هر پارامتر سازنده اصلی ایجاد می‌کند. این مورد در کلاس‌ها و ساختارها صدق نمی‌کند؛ برای دستیابی به همین نتیجه، باید آن خصوصیات را به صراحت تعریف کنید:

```C#

class Person (string firstName, string lastName)
{
 public string FirstName { get; set; } = firstName;
 public string LastName { get; set; } = lastName;
 }
```
سازنده‌های اصلی در سناریوهای ساده به خوبی کار می‌کنند. ما ظرایف و محدودیت‌های آن‌ها را در "سازنده‌های اصلی (سی‌شارپ ۱۲)" در صفحه ۱۱۹ شرح می‌دهیم.

## پارامترهای پیش‌فرض عبارت‌های لامبدا Default lambda parameters

همانطور که متدهای عادی می‌توانند پارامترهایی با مقادیر پیش‌فرض تعریف کنند:

```C#

void Print (string message = "") => Console.WriteLine (message);
```
عبارت‌های لامبدا نیز می‌توانند:

C#

var print = (string message = "") => Console.WriteLine (message);
print ("Hello");
print ();
این ویژگی با کتابخانه‌هایی مانند رابط برنامه‌نویسی کاربردی حداقلی ای‌اس‌پی‌نت مفید است.

## نام مستعار برای هر نوع Alias any type

سی‌شارپ همیشه به شما اجازه داده است که با استفاده از دستور using، یک نام مستعار برای یک نوع ساده یا عمومی ایجاد کنید:

```C#

using ListOfInt = System.Collections.Generic.List;
var list = new ListOfInt();
```
از سی‌شارپ ۱۲ به بعد، این رویکرد با انواع دیگر نیز کار می‌کند، مانند آرایه‌ها و تاپِل‌ها:

```C#

using NumberList = double[];
using Point = (int X, int Y);
NumberList numbers = { 2.5, 3.5 };
Point p = (3, 4);
```
## سایر ویژگی‌های جدید

سی‌شارپ ۱۲ همچنین از آرایه‌های درون‌خطی، از طریق خصیصه [System.Runtime.CompilerServices.InlineArray] پشتیبانی می‌کند. این امکان ایجاد آرایه‌های با اندازه ثابت در یک ساختار را بدون نیاز به یک زمینه ناامن فراهم می‌کند و در درجه اول برای استفاده در رابط‌های برنامه‌نویسی کاربردی زمان اجرا در نظر گرفته شده است.

## تازه‌های سی‌شارپ ۱۱

سی‌شارپ ۱۱ همراه با ویژوال استودیو ۲۰۲۲ عرضه شد و به طور پیش‌فرض زمانی که دات‌نت ۷ را هدف قرار می‌دهید، استفاده می‌شود.
